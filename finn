#!/bin/bash 
#echo -- $@
#echo -- $1
#echo "$1"
#echo "???"
D=0

where=.

for i; do 
	#echo $i
	if [ "$i" = "@" ] ; then D=1; break; fi

	if [ -d "$i" ];   then
		where=$i; continue; fi

	arg="$(
	# echo bug: echo -n '-n' -n
	echo @%$i | sed -E '
	s/^@%//
	s/^-t?f$/-type f/
	s/^-t?d$/-type d/
	s/^-n$/-name/
	s/^-i$/-iname/
	')"


	if [[ -z "$args" ]]; then ws=''; else ws=' '; fi # avoid appending a whitespace to a lone arg
	if [ -n "$arg" ]; then args="$args$ws$arg"; fi
done

if [[ "$1" == "$args" ]]; then
	eval /usr/bin/find $where -name "\*$1\*"
	exit
fi

if [ $D -gt 0 ];then echo /usr/bin/find $where $args; fi
eval /usr/bin/find $where $args


